- name: Associate an Interface Access Port Selector to an Interface Policy Leaf Profile with a Policy Group
  aci_access_port_to_interface_policy_leaf_profile:
    host: "{{ apic_url }}"
    username: "{{ apic_username }}"
    password: "{{ apic_password }}"
    validate_certs: no
    lag_type: node
    interface_profile: "{{ item.leaf_int_selector_profile | trim }}"
    access_port_selector: "{{ item.interface_name | trim }}"
    port_blk: "{{ item.port_blk_name | trim }}"
    from_port: "{{ item.from_port | trim }}"
    to_port: "{{ item.to_port | trim }}"
    policy_group: "{{ item.policy_group | trim }}"
    state: present
  when: (item.leaf_int_selector_profile | trim) != ""

- name: Pause after End Point Group creation
  pause:
    seconds: 1
  when: (item.leaf_int_selector_profile | trim) != ""