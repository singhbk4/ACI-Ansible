---
- name: ACI Configuration
  hosts: APIC-Group
  connection: local
  gather_facts: no

  vars:
    apic_info:        &apic_info
      host:           '{{ inventory_hostname }}'
      username:       '{{ lookup("env", "ANSIBLE_NET_USERNAME") }}'
      password:       '{{ lookup("env", "ANSIBLE_NET_PASSWORD") }}'
      validate_certs: "false"
      
    BD_Constructs:
    - tenant: Outer-DMZ
      vrf: Outer-VRF
      BD: VLAN10
    - tenant: Outer-DMZ
      vrf: Outer-VRF
      BD: VLAN20
    - tenant: Outer-DMZ
      vrf: Outer-VRF
      BD: VLAN30      

  tasks: 
  - name: Add Bridge Domain "{{BDs}}"
    aci_bd:
      <<: *apic_info
      state: present
      tenant: "{{item.tenant}}"
      bd: "{{item.BD}}"
      vrf: "{{item.vrf}}"
    with_items:
       - "{{BD_Constructs}}"
